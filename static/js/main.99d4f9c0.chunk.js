(this.webpackJsonpplatformer=this.webpackJsonpplatformer||[]).push([[0],{18:function(e,o,t){},19:function(e,o,t){"use strict";t.r(o);var i=t(0),n=t(3),c=t.n(n),a=t(9),l=t(7),r={tileSize:16,keys:[{id:0,colour:"#333",solid:0},{id:1,colour:"#888",solid:0},{id:2,colour:"#555",solid:1,bounce:.35},{id:3,colour:"rgba(121, 220, 242, 0.4)",friction:{x:.9,y:.9},gravity:{x:0,y:.1},jump:1,fore:1},{id:4,colour:"#777",jump:1},{id:5,colour:"#E373FA",solid:1,bounce:1.1},{id:6,colour:"#666",solid:1,bounce:0},{id:7,colour:"#73C6FA",solid:0,script:"change_colour"},{id:8,colour:"#FADF73",solid:0,script:"next_level"},{id:9,colour:"#C93232",solid:0,script:"death"},{id:10,colour:"#555",solid:1},{id:11,colour:"#0FF",solid:0,script:"unlock"},{id:12,colour:"#555",solid:1}],data:[[2,2,2,2,2,2,2,2,2,2,2,2,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,6,6,6,6,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,1,1,1,1,2,2,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,7,1,1,1,1,1,12,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,4,2,2,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,12,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2,2,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,2,2,2,2,2],[2,1,2,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,1,1,1,1,2],[2,1,2,2,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,1,1,1,1,2],[2,1,2,2,2,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,1,1,1,1,2],[2,1,2,2,2,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,2,12,2,2,2,2,2,2,2,2,8,1,1,1,2],[2,1,2,2,2,2,2,2,2,2,2,6,2,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,2,2,2,2,2,2,2,12,2,2,2,2,2,2,2,2,2,2,2,4,2],[2,1,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,2,2,2,9,9,9,2,10,10,10,10,10,10,1,1,1,1,1,1,1,11,2,2,2,2,4,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,2],[2,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,1,1,1,1,1,1,2],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2],[2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,6,6,6,2,2,2,2,2,2,6,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],[2,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,2,5,5,2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5,5,5,1,1,1,1,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]],gravity:{x:0,y:.3},velLimit:{x:2,y:16},movementSpeed:{jump:6,left:.3,right:.3},player:{x:2,y:2,colour:"#FF9900"},scripts:{change_colour:'this.player.colour = "#"+(Math.random()*0xFFFFFF<<0).toString(16);',next_level:'alert("Yay! You won! Reloading map.");this.load_map(map);',death:'alert("You died!");this.load_map(map);',unlock:'this.current_map.keys[10].solid = 0;this.current_map.keys[10].colour = "#888";'}},u=t(1),d=function(e){var o,t,n,c,a=e.canvasHeight,l=e.canvasWidth,d=Object(i.useRef)(),s=Object(i.useRef)(),h={left:!1,right:!1,up:!1},y={x:200,y:200},v=16,f=!1,x=0,m={x:0,y:0},p={loc:{x:0,y:0},vel:{x:0,y:0},canJump:!0,colour:"#FF9900"},b=function(e){n=e.touches[0].clientX,c=e.touches[0].clientY},g=function(){h.left=!1,h.up=!1,h.right=!1},M=function(e){c>e.touches[0].clientY+5&&(h.up=!0),n>e.touches[0].clientX&&(h.left=!0),n<e.touches[0].clientX&&(h.right=!0)},w=function(e){switch(e.keyCode){case 37:h.left=!0;break;case 32:case 38:h.up=!0;break;case 39:h.right=!0}},k=function(e){switch(e.keyCode){case 37:h.left=!1;break;case 32:case 38:h.up=!1;break;case 39:h.right=!1}},E=function(e){return"undefined"===typeof e||"undefined"===typeof e.data||"undefined"===typeof e.keys?(console.error("Error: Invalid map data!"),!1):((t=e).background=e.background||"#333",t.gravity=e.gravity||{x:0,y:.3},t.width=0,t.height=0,v=e.tileSize||16,e.keys.forEach((function(o){e.data.forEach((function(e,i){t.height=Math.max(t.height,i),e.forEach((function(e,n){t.width=Math.max(t.width,n),e===o.id&&(t.data[i][n]=o)}))}))})),t.widthP=t.width*v,t.heightP=t.height*v,p.loc.x=e.player.x*v||0,p.loc.y=e.player.y*v||0,p.colour=e.player.colour||"#000",p.vel={x:0,y:0},m={x:0,y:0},!0)};Object(i.useEffect)((function(){y.x=l,y.y=a,f=!0,E(r)}),[]);var j=function(e,o){return t.data[o]&&t.data[o][e]?t.data[o][e]:0},O=function(){h.left&&p.vel.x>-t.velLimit.x&&(p.vel.x-=t.movementSpeed.left),h.up&&p.canJump&&p.vel.y>-t.velLimit.y&&(p.vel.y-=t.movementSpeed.jump,p.canJump=!1),h.right&&p.vel.x<t.velLimit.x&&(p.vel.x+=t.movementSpeed.left),function(){var e=p.loc.x+p.vel.x,i=p.loc.y+p.vel.y,n=Math.round(v/2-1),c=j(Math.round(p.loc.x/v),Math.round(p.loc.y/v));c.gravity?(p.vel.x+=c.gravity.x,p.vel.y+=c.gravity.y):(p.vel.x+=t.gravity.x,p.vel.y+=t.gravity.y),c.friction&&(p.vel.x*=c.friction.x,p.vel.y*=c.friction.y);var a=Math.floor(i/v),l=Math.ceil(i/v),u=Math.round((p.loc.y-n)/v),d=Math.round((p.loc.y+n)/v),s=Math.floor(e/v),h=Math.ceil(e/v),b=Math.round((p.loc.x-n)/v),g=Math.round((p.loc.x+n)/v),M=j(b,a),w=j(g,a),k=j(b,l),O=j(g,l),_=j(s,u),F=j(s,d),L=j(h,u),S=j(h,d);if(c.jump&&x>15?(p.canJump=!0,x=0):x+=1,p.vel.x=Math.min(Math.max(p.vel.x,-t.velLimit.x),t.velLimit.x),p.vel.y=Math.min(Math.max(p.vel.y,-t.velLimit.y),t.velLimit.y),p.loc.x+=p.vel.x,p.loc.y+=p.vel.y,p.vel.x*=.9,_.solid||F.solid||L.solid||S.solid){for(;j(Math.floor(p.loc.x/v),u).solid||j(Math.floor(p.loc.x/v),d).solid;)p.loc.x+=.1;for(;j(Math.ceil(p.loc.x/v),u).solid||j(Math.ceil(p.loc.x/v),d).solid;)p.loc.x-=.1;var P=0;_.solid&&_.bounce>P&&(P=_.bounce),F.solid&&F.bounce>P&&(P=F.bounce),L.solid&&L.bounce>P&&(P=L.bounce),S.solid&&S.bounce>P&&(P=S.bounce),p.vel.x*=-P||0}if(M.solid||w.solid||k.solid||O.solid){for(;j(b,Math.floor(p.loc.y/v)).solid||j(g,Math.floor(p.loc.y/v)).solid;)p.loc.y+=.1;for(;j(b,Math.ceil(p.loc.y/v)).solid||j(g,Math.ceil(p.loc.y/v)).solid;)p.loc.y-=.1;var R=0;M.solid&&M.bounce>R&&(R=M.bounce),w.solid&&w.bounce>R&&(R=w.bounce),k.solid&&k.bounce>R&&(R=k.bounce),O.solid&&O.bounce>R&&(R=O.bounce),p.vel.y*=-R||0,!k.solid&&!O.solid||c.jump||(p.onFloor=!0,p.canJump=!0)}var Y=Math.round(p.loc.x-y.x/2),A=Math.round(p.loc.y-y.y/2),T=Math.abs(Y-m.x),J=Math.abs(A-m.y);if(T>5){var X=Math.round(Math.max(1,.1*T));Y!==m.x&&(m.x+=Y>m.x?X:-X,f&&(m.x=Math.min(t.widthP-y.x+v,m.x),m.x=Math.max(0,m.x)))}if(J>5){var I=Math.round(Math.max(1,.1*J));A!==m.y&&(m.y+=A>m.y?I:-I,f&&(m.y=Math.min(t.heightP-y.y+v,m.y),m.y=Math.max(0,m.y)))}if(o!==c.id&&c.script)switch(c.script){case"death":console.error("You died! Try again."),E(r);break;case"change_colour":t.keys[12].solid=0,t.keys[12].colour="#888",p.colour="#FF0000";break;case"unlock":t.keys[10].solid=0,t.keys[10].colour="#888";break;case"next_level":console.warn("Yay! You won! Reloading map."),E(r);break;default:console.error(t.scripts[c.script])}o=c.id}()},_=function(e,o,t,i){null!==t&&void 0!==t&&t.colour&&(i.fillStyle=t.colour,i.fillRect(e,o,v,v))},F=function e(o,i){for(var n=0;n<t.data.length;n+=1)for(var c=0;c<t.data[n].length;c+=1)if(!i&&!t.data[n][c].fore||i&&t.data[n][c].fore){var a=c*v-m.x,l=n*v-m.y;a<-v||l<-v||a>y.x||l>y.y||_(a,l,t.data[n][c],o)}i||e(o,!0)},L=function(e){F(e,!1),function(e){e.fillStyle=p.colour,e.beginPath(),e.arc(p.loc.x+v/2-m.x,p.loc.y+v/2-m.y,v/2-1,0,2*Math.PI),e.fill()}(e)},S=function e(){!function(){var e=d.current.getContext("2d");e.fillStyle="#333",e.fillRect(0,0,l,a),O(),L(e)}(),s.current=window.requestAnimationFrame(e)};return Object(i.useEffect)((function(){return document.addEventListener("keydown",w),document.addEventListener("keyup",k),("ontouchstart"in window||navigator.msMaxTouchPoints)&&(document.addEventListener("touchstart",b),document.addEventListener("touchend",g),document.addEventListener("touchmove",M)),s.current=window.requestAnimationFrame(S),function(){cancelAnimationFrame(s.current),document.removeEventListener("keydown",w),document.removeEventListener("keyup",k),("ontouchstart"in window||navigator.msMaxTouchPoints)&&(document.removeEventListener("touchstart",b),document.removeEventListener("touchend",g),document.removeEventListener("touchmove",M))}})),Object(u.jsx)("canvas",{"data-testid":"main-canvas",ref:d,height:a,width:l,style:l>=800?{display:"block",margin:"7rem auto"}:null})},s=function(){var e=Object(i.useState)(0),o=Object(l.a)(e,2),t=o[0],n=o[1],c=Object(i.useState)(0),a=Object(l.a)(c,2),r=a[0],s=a[1];return Object(i.useEffect)((function(){var e=window.innerWidth<800;n(e?window.innerHeight-20:450),s(e?window.innerWidth-20:800)}),[]),t?Object(u.jsx)(d,{canvasHeight:t,canvasWidth:r}):null},h=t(6),y=t(2),v={position:[0,0],spriteLocation:"0px 0px",walkIndex:0,direction:"EAST"},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"MOVE_PLAYER"===o.type?Object(y.a)({},o.payload):e},x=Object(h.a)({player:f}),m=Object(h.b)(x,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());t(18);c.a.render(Object(u.jsx)(a.a,{store:m,children:Object(u.jsx)(s,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.99d4f9c0.chunk.js.map