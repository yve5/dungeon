(this.webpackJsonpdungeon=this.webpackJsonpdungeon||[]).push([[0],{17:function(o,e,t){},18:function(o,e,t){"use strict";t.r(e);var i=t(0),n=t(3),c=t.n(n),l=t(8),a={tileSize:16,keys:[{id:0,colour:"#333",solid:0},{id:1,colour:"#888",solid:0},{id:2,colour:"#555",solid:1,bounce:.35},{id:3,colour:"rgba(121, 220, 242, 0.4)",friction:{x:.9,y:.9},gravity:{x:0,y:.1},jump:1,fore:1},{id:4,colour:"#777",jump:1},{id:5,colour:"#E373FA",solid:1,bounce:1.1},{id:6,colour:"#666",solid:1,bounce:0},{id:7,colour:"#73C6FA",solid:0,script:"change_colour"},{id:8,colour:"#FADF73",solid:0,script:"next_level"},{id:9,colour:"#C93232",solid:0,script:"death"},{id:10,colour:"#555",solid:1},{id:11,colour:"#0FF",solid:0,script:"unlock"},{id:12,colour:"#555",solid:1}],data:[[2,2,2,2,2,2,2,2,2,2,2,2,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,6,6,6,6,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,1,1,1,1,2,2,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,7,1,1,1,1,1,12,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,4,2,2,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,12,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2,2,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,2,12,2],[2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2],[2,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,2,2,2,2,2],[2,1,2,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,1,1,1,1,2],[2,1,2,2,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,1,1,1,1,2],[2,1,2,2,2,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,4,2,12,2,2,2,2,2,2,2,2,1,1,1,1,2],[2,1,2,2,2,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,2,12,2,2,2,2,2,2,2,2,8,1,1,1,2],[2,1,2,2,2,2,2,2,2,2,2,6,2,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,2,2,2,2,2,2,2,12,2,2,2,2,2,2,2,2,2,2,2,4,2],[2,1,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,2,2,2,9,9,9,2,10,10,10,10,10,10,1,1,1,1,1,1,1,11,2,2,2,2,4,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,2],[2,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,1,1,1,1,1,1,2],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2],[2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,6,6,6,2,2,2,2,2,2,6,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],[2,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,2,5,5,2,1,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5,5,5,1,1,1,1,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]],gravity:{x:0,y:.3},velLimit:{x:2,y:16},movementSpeed:{jump:6,left:.3,right:.3},player:{x:2,y:2,colour:"#FF9900"},scripts:{change_colour:'this.player.colour = "#"+(Math.random()*0xFFFFFF<<0).toString(16);',next_level:'alert("Yay! You won! Reloading map.");this.load_map(map);',death:'alert("You died!");this.load_map(map);',unlock:'this.current_map.keys[10].solid = 0;this.current_map.keys[10].colour = "#888";'}},r=t(1),u=function(){var o,e,t,n,c=Object(i.useRef)(),l=Object(i.useRef)(),u={left:!1,right:!1,up:!1},d=16,s=!1,h=0,y={x:200,y:200},v={x:0,y:0},x={loc:{x:0,y:0},vel:{x:0,y:0},canJump:!0,colour:"#FF9900"},f=function(o){t=o.touches[0].clientX,n=o.touches[0].clientY},m=function(){u.left=!1,u.up=!1,u.right=!1},p=function(o){n>o.touches[0].clientY+5&&(u.up=!0),t>o.touches[0].clientX&&(u.left=!0),t<o.touches[0].clientX&&(u.right=!0)},b=function(o){switch(o.keyCode){case 37:u.left=!0;break;case 32:case 38:u.up=!0;break;case 39:u.right=!0}},g=function(o){switch(o.keyCode){case 37:u.left=!1;break;case 32:case 38:u.up=!1;break;case 39:u.right=!1}},M=function(o){return"undefined"===typeof o||"undefined"===typeof o.data||"undefined"===typeof o.keys?(console.error("Error: Invalid map data!"),!1):((e=o).background=o.background||"#333",e.gravity=o.gravity||{x:0,y:.3},e.width=0,e.height=0,d=o.tileSize||16,o.keys.forEach((function(t){o.data.forEach((function(o,i){e.height=Math.max(e.height,i),o.forEach((function(o,n){e.width=Math.max(e.width,n),o===t.id&&(e.data[i][n]=t)}))}))})),e.widthP=e.width*d,e.heightP=e.height*d,x.loc.x=o.player.x*d||0,x.loc.y=o.player.y*d||0,x.colour=o.player.colour||"#000",x.vel={x:0,y:0},v={x:0,y:0},!0)};Object(i.useEffect)((function(){y.x=600,y.y=600,s=!0,M(a)}),[]);var k=function(o,t){return e.data[t]&&e.data[t][o]?e.data[t][o]:0},w=function(){u.left&&x.vel.x>-e.velLimit.x&&(x.vel.x-=e.movementSpeed.left),u.up&&x.canJump&&x.vel.y>-e.velLimit.y&&(x.vel.y-=e.movementSpeed.jump,x.canJump=!1),u.right&&x.vel.x<e.velLimit.x&&(x.vel.x+=e.movementSpeed.left),function(){var t=x.loc.x+x.vel.x,i=x.loc.y+x.vel.y,n=Math.round(d/2-1),c=k(Math.round(x.loc.x/d),Math.round(x.loc.y/d));c.gravity?(x.vel.x+=c.gravity.x,x.vel.y+=c.gravity.y):(x.vel.x+=e.gravity.x,x.vel.y+=e.gravity.y),c.friction&&(x.vel.x*=c.friction.x,x.vel.y*=c.friction.y);var l=Math.floor(i/d),r=Math.ceil(i/d),u=Math.round((x.loc.y-n)/d),f=Math.round((x.loc.y+n)/d),m=Math.floor(t/d),p=Math.ceil(t/d),b=Math.round((x.loc.x-n)/d),g=Math.round((x.loc.x+n)/d),w=k(b,l),E=k(g,l),_=k(b,r),F=k(g,r),L=k(m,u),j=k(m,f),O=k(p,u),S=k(p,f);if(c.jump&&h>15?(x.canJump=!0,h=0):h+=1,x.vel.x=Math.min(Math.max(x.vel.x,-e.velLimit.x),e.velLimit.x),x.vel.y=Math.min(Math.max(x.vel.y,-e.velLimit.y),e.velLimit.y),x.loc.x+=x.vel.x,x.loc.y+=x.vel.y,x.vel.x*=.9,L.solid||j.solid||O.solid||S.solid){for(;k(Math.floor(x.loc.x/d),u).solid||k(Math.floor(x.loc.x/d),f).solid;)x.loc.x+=.1;for(;k(Math.ceil(x.loc.x/d),u).solid||k(Math.ceil(x.loc.x/d),f).solid;)x.loc.x-=.1;var P=0;L.solid&&L.bounce>P&&(P=L.bounce),j.solid&&j.bounce>P&&(P=j.bounce),O.solid&&O.bounce>P&&(P=O.bounce),S.solid&&S.bounce>P&&(P=S.bounce),x.vel.x*=-P||0}if(w.solid||E.solid||_.solid||F.solid){for(;k(b,Math.floor(x.loc.y/d)).solid||k(g,Math.floor(x.loc.y/d)).solid;)x.loc.y+=.1;for(;k(b,Math.ceil(x.loc.y/d)).solid||k(g,Math.ceil(x.loc.y/d)).solid;)x.loc.y-=.1;var R=0;w.solid&&w.bounce>R&&(R=w.bounce),E.solid&&E.bounce>R&&(R=E.bounce),_.solid&&_.bounce>R&&(R=_.bounce),F.solid&&F.bounce>R&&(R=F.bounce),x.vel.y*=-R||0,!_.solid&&!F.solid||c.jump||(x.onFloor=!0,x.canJump=!0)}var Y=Math.round(x.loc.x-y.x/2),A=Math.round(x.loc.y-y.y/2),T=Math.abs(Y-v.x),J=Math.abs(A-v.y);if(T>5){var X=Math.round(Math.max(1,.1*T));Y!==v.x&&(v.x+=Y>v.x?X:-X,s&&(v.x=Math.min(e.widthP-y.x+d,v.x),v.x=Math.max(0,v.x)))}if(J>5){var I=Math.round(Math.max(1,.1*J));A!==v.y&&(v.y+=A>v.y?I:-I,s&&(v.y=Math.min(e.heightP-y.y+d,v.y),v.y=Math.max(0,v.y)))}if(o!==c.id&&c.script)switch(c.script){case"death":console.error("You died! Try again."),M(a);break;case"change_colour":e.keys[12].solid=0,e.keys[12].colour="#888",x.colour="#FF0000";break;case"unlock":e.keys[10].solid=0,e.keys[10].colour="#888";break;case"next_level":console.warn("Yay! You won! Reloading map."),M(a);break;default:console.error(e.scripts[c.script])}o=c.id}()},E=function(o,e,t,i){null!==t&&void 0!==t&&t.colour&&(i.fillStyle=t.colour,i.fillRect(o,e,d,d))},_=function o(t,i){for(var n=0;n<e.data.length;n+=1)for(var c=0;c<e.data[n].length;c+=1)if(!i&&!e.data[n][c].fore||i&&e.data[n][c].fore){var l=c*d-v.x,a=n*d-v.y;if(l<-d||a<-d||l>y.x||a>y.y)continue;E(l,a,e.data[n][c],t)}i||o(t,!0)},F=function(o){_(o,!1),function(o){o.fillStyle=x.colour,o.beginPath(),o.arc(x.loc.x+d/2-v.x,x.loc.y+d/2-v.y,d/2-1,0,2*Math.PI),o.fill()}(o)},L=function o(){!function(){var o=c.current.getContext("2d");o.fillStyle="#333",o.fillRect(0,0,600,600),w(),F(o)}(),l.current=window.requestAnimationFrame(o)};return Object(i.useEffect)((function(){return document.addEventListener("keydown",b),document.addEventListener("keyup",g),("ontouchstart"in window||navigator.msMaxTouchPoints)&&(document.addEventListener("touchstart",f),document.addEventListener("touchend",m),document.addEventListener("touchmove",p)),l.current=window.requestAnimationFrame(L),function(){cancelAnimationFrame(l.current),document.removeEventListener("keydown",b),document.removeEventListener("keyup",g),("ontouchstart"in window||navigator.msMaxTouchPoints)&&(document.removeEventListener("touchstart",f),document.removeEventListener("touchend",m),document.removeEventListener("touchmove",p))}})),Object(r.jsx)("canvas",{"data-testid":"main-canvas",ref:c,style:{margin:"40px auto 20px",display:"block"},height:600,width:600})},d=function(){return Object(r.jsx)(u,{})},s=t(6),h=t(2),y={position:[0,0],spriteLocation:"0px 0px",walkIndex:0,direction:"EAST"},v=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"MOVE_PLAYER"===e.type?Object(h.a)({},e.payload):o},x=Object(s.a)({player:v}),f=Object(s.b)(x,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());t(17);c.a.render(Object(r.jsx)(l.a,{store:f,children:Object(r.jsx)(d,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.dbb760ae.chunk.js.map